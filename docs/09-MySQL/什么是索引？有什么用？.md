# 什么是索引？有什么用？

在 MySQL 中，索引（Index）是一种数据结构，用于加速数据库查询操作。它类似于书籍的目录或索引页，通过提供快速定位数据的途径，减少了查询时需要扫描的数据量，从而显著提高查询效率。

## 索引的基本概念

> MySQL官方对索引的定义：**索引（Index）是帮助MySQL高效获取数据的数据结构**。

- 定义：索引是数据库中一个独立的、物理的结构，它存储了表中某些字段的值及其对应的行位置信息。
- 作用：通过索引，MySQL 可以快速定位到满足查询条件的记录，而不需要扫描整个表。

## 索引的本质

索引是一种数据结构。我们可以理解为“排好序的快速查找数据结构”，满足特定查找算法。这些数据结构以某种方式指向数据，这样就可以在这些数据结构的基础上实现`高级查找算法`。

索引是在存储引擎中实现的，因此每种存储引擎支持的索引类型可能会有所不同。并且每种存储引擎不一定支持所有的所有类型。 例如，InnoDB 支持 B-Tree 索引和全文索引等，而 MyISAM 则支持全文本索引。

同时，存储引擎可以定义每个表的`最大索引数`和`最大索引长度`。所有存储引擎支持每个表至少16个索引，总索引长度至少为 256 字节。有些存储引擎支持更多的索引数和更大的索引长度。

## 索引的优缺点

### 索引的优点

- **提高查询效率**：减少查询时扫描的数据量，**降低数据库IO成本**，特别是对于大表。（这也是创建索引最主要的原因）
- **唯一性约束**：通过唯一索引（UNIQUE）可以保证数据库表中每一行`数据的唯一性`。
- **加速表连接**：在实现数据的参考完整性方面，可以`加速表和表之间的连接`。换句话说，对于有依赖关系的子表和父表联合查询时，可以提高查询速度。
- **加速排序和分组**：索引可以加速 ORDER BY 和 GROUP BY 操作，可以显著`减少查询中分组和排序的时间`，降低了CPU的消耗。

### 索引的缺点

- **占用额外存储空间**：索引本身需要占用磁盘空间，过多的索引可能导致存储资源浪费。
  - 索引需要占`磁盘空间`，除了数据表占数据空间之外，每一个索引还要占一定的物理空间`存储在磁盘上`，如果有大量的索引，索引文件就可能比数据文件更快达到最大文件尺寸。
- **增加写入开销**：每次插入、更新或删除记录时，MySQL 都需要维护索引，这会增加写入操作的时间。
  - 创建索引和维护索引要`耗费时间`，并且随着数据量的增加，所耗费的时间也会增加
  - 虽然索引大大提高了查询速度，同时却会`降低更新表的速度`。当对表中的数据进行增加、删除和修改的时候，索引也要动态地维护，这样就降低了数据的维护速度
- **复杂化查询优化**：过多的索引可能会使查询优化器的选择更加复杂，反而影响性能。

## 创建和删除索引

> [创建、查看、删除索引](./创建、查看、删除索引.md)

```sql
-- 创建索引
CREATE INDEX index_name ON table_name (column1, column2, ...);

-- 查看索引
SHOW INDEX FROM table_name;

-- 删除索引
DROP INDEX index_name ON table_name;  
```

## 索引的使用建议

- 选择合适的字段：优先为经常用于查询条件的字段创建索引。
- 避免过度索引：不要为每个字段都创建索引，应根据实际查询需求合理选择。
- 定期分析和优化：使用 ANALYZE TABLE 和 OPTIMIZE TABLE 定期分析和优化表结构，确保索引的有效性。

:::tip 提示

[索引设计原则](./索引设计原则.md)

:::

## 索引的分类

- 按【物理存储】分类：聚簇索引（主键索引）、非聚簇索引（二级索引、辅助索引）
- 按【数据结构】分类：b+树索引、hash索引、full-text索引
- 按【字段特性】分类：主键索引、唯一索引、普通索引、前缀索引
- 按【字段个数】分类：单列索引、联合索引（多列索引、复合索引）

:::tip
索引分类具体可以看这里：[MySQL有哪些索引类型？](./MySQL有哪些索引类型？（索引分类）.md)
:::

:::warning 注意
你可能还听说过**覆盖索引**，它不是索引，是联合索引命中的一种表现形式
:::
