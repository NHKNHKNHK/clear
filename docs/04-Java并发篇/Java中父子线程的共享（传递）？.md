# Java中父子线程的共享（传递）？

>   **注意**：`ThreadLocal` 并不直接支持父子线程之间的数据共享，因为每个线程都有独立的副本。如果需要共享数据，可以结合其他机制（如共享变量或阻塞队列）。

这里有两个工具类可以实现父子线程数据传递：

-   `InheritableThreadLocal`（JDK自带）
-   `TransmittableThreadLocal`（alibaba）

**ThreadLocal**：每个线程拥有独立的变量副本，线程之间无法直接共享数据。

**InheritableThreadLocal**：除了为每个线程提供独立的变量副本外，还允许子线程继承父线程的变量值。

>   **注意**：
>
>   子线程只能继承父线程的初始值，后续父线程对变量的修改不会影响子线程的值。
>
>   这也是Alibaba为什么要自己搞一个`TransmittableThreadLocal`的原因，他解决了线程池复用的问题

**TransmittableThreadLocal**：它扩展了 Java 原生的 `InheritableThreadLocal`，支持在线程池中跨线程传递数据，有效避免了线程池复用导致的数据泄露问题



| 特性                     | ThreadLocal                | InheritableThreadLocal       | TransmittableThreadLocal           |
| :----------------------- | :------------------------- | :--------------------------- | :--------------------------------- |
| **定义**                 | 每个线程拥有独立的变量副本 | 子线程可以继承父线程的变量值 | 支持在线程池和异步调用中传递上下文 |
| **是否支持父子线程共享** | 否                         | 是（子线程继承父线程的值）   | 是（子线程继承父线程的值）         |
| **是否支持线程池场景**   | 否，存在内存泄露           | 否，存在内存泄露             | 是                                 |
| **是否支持异步调用**     | 否                         | 否                           | 是                                 |
