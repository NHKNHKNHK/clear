# 什么时候用公平锁？什么时候用非公平锁？

-   **使用公平锁的场景**：
    -   **实时性要求高**：当系统中某些任务对响应时间有严格要求，必须按照请求顺序执行时，应使用公平锁。
    -   **避免线程饥饿**：在多线程环境中，若存在大量竞争且某些线程长期无法获取锁资源，使用公平锁可以确保每个线程最终都能获得锁。
    -   **特定业务逻辑需求**：例如银行转账等金融交易系统，可能需要严格按照请求顺序处理事务，以保证数据一致性。
-   **使用非公平锁的场景**：
    -   **性能优先**：大多数情况下，非公平锁能提供更高的吞吐量和更低的延迟，适用于对性能敏感的应用。
    -   **线程饥饿风险低**：如果系统中的线程数量较少或竞争不激烈，选择非公平锁可以在不影响公平性的前提下提高效率。
    -   **无严格顺序要求**：当业务逻辑不要求严格的执行顺序，允许一定程度上的随机性时，非公平锁是更好的选择。

**总结**

-   当需要更高的吞吐量和更低的延迟情况下，使用非公平锁比较合适，可以节省很多线程切换时间

-   否则就可以使用公平锁（不存在线程饥饿）