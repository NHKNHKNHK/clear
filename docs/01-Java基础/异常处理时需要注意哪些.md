# 异常处理时需要注意哪些

异常处理时需要注意以下六点：

**（1）尽量不要捕获类似于Exception这样的通用异常，而应该捕获特定的异常**

**（2）不要”吞“了异常**

如果我们捕获了异常，却不把异常抛出，也没有写入到日志里，那么会发生什么情况？

线上除了bug莫名其妙的任何的信息，你都不知道哪里出错，出错的原因是什么，这会导致一个简单的bug难以排查。

还有就是如果你的项目中使用了spring的声明式事务，那么事务也不会回滚。

还有些人，喜欢在使用了catch之后用`e.printStackTrace`，在开发中，通常是不推荐这种做法的，一般情况下这样子做没有问题，这个方法输出的是一个标准错误流。

比如在分布式系统中，发生异常但找不到stackTrace。

所以最好是输入到日志中，定义自己公司的格式，将详细的信息输入到日志系统中，适合清晰高效的排查错误。

**（3）不要延迟处理异常**

比如你有一个方法，参数是name，函数内部调了别的好几个方法，其实你的name传递的是null值，但是你没有在进入这个方法或一开始就处理这个情况，而是在你调用了好几个别的方法后爆出了这个空指针。

**（4）只在需要try-catch的地方try-catch，try-catch的范围能小则小**

只在需要try-catch的地方使用，不要滥用，因为try-catch中的代码会影响JVM对代码的优化，例如重排序。

**（5）不要通过异常来控制程序流程**

一些可以使用if/else的条件语句来判断的，例如null值等，就不要使用异常，异常肯定是比一些条件语句低效的，有CPU分支预测的优化等。

而且每次实例化一个异常都会对栈进行快照，相对而言这是一个比较重的操作，如果数量过多开销就不能被忽略了

**（6）不要在finally代码块中处理返回值或直接return**

在finally中处理返回值或直接return会发生很诡异的事情，比如覆盖了try中的return，或者屏蔽了异常
