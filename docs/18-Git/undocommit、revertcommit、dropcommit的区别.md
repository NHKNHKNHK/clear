---
permalink: /git/git-undo-revert-drop-commit
---

# undo commit、revert commit、drop commit的区别

## 口语化

三者核心区别在于是否保留提交历史、是否影响协作分支 ——undo（reset）回滚本地提交历史，revert 新增反向提交保留历史，drop（删除提交）仅本地彻底移除提交记录

## undo commit（Git reset）

将当前分支的 HEAD 指针移到指定提交，本质是 “回滚” 提交历史，可选择保留或丢弃工作区 / 暂存区修改。

**常用命令**：

- `git reset --soft <commit-id>`：保留工作区和暂存区修改，仅回滚提交记录。
- `git reset --mixed <commit-id>`（默认）：保留工作区修改，清空暂存区，回滚提交记录。
- `git reset --hard <commit-id>`：彻底丢弃工作区和暂存区修改，完全回滚到目标提交。

**关键影响**：会修改本地提交历史，若已将提交推送到远程，强行推送（git push -f）会覆盖远程分支，影响协作。

**适用场景**：本地开发时，想撤销最近未推送的提交（如提交错误代码、提交信息写错）。

## revert commit（Git revert）

创建一个新的 “反向提交”，抵消目标提交的修改，不改变原有提交历史。

**常用命令**：

- `git revert <commit-id>`：针对单个提交创建反向提交。
- `git revert <old-commit-id>..<new-commit-id>`：批量撤销多个连续提交。

**关键影响**：保留完整提交历史，新提交会被记录，推送远程后不影响协作分支，是最安全的 “撤销” 方式。

**适用场景**：已将提交推送到远程协作分支（如主分支），需要撤销错误提交（避免修改公共历史）。

## drop commit（Git rebase -i 删除提交）

通过交互式变基，直接从提交历史中删除指定提交，属于 “彻底移除” 操作。

**常用命令**：

- `git rebase -i <commit-id>`（目标提交的上一个 ID）。
- 在弹出的编辑界面中，将目标提交前的 pick 改为 drop（或直接删除该行），保存退出。

**关键影响**：修改本地提交历史，删除的提交会彻底消失，若已推送该提交到远程，强行推送会引发冲突。

**适用场景**：本地开发时，清理无用提交（如测试提交、重复提交），整理干净的提交历史后再推送远程

### 总结

| 操作           | 提交历史保留     | 影响协作分支     | 风险程度 | 核心场景                   |
| -------------- | ---------------- | ---------------- | -------- | -------------------------- |
| undo（reset）  | 不保留（修改）   | 影响（强推覆盖） | 中高     | 本地未推送的错误提交撤销   |
| revert         | 保留（新增提交） | 无影响           | 低       | 远程协作分支的错误提交撤销 |
| drop（rebase） | 不保留（删除）   | 影响（冲突）     | 高       | 本地无用提交清理、历史整理 |
