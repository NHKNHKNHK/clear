# Redis key过期了，为什么内存没释放？

## **口语化**

当redis中的key过期时，虽然这个key在逻辑上已经过期了，但redis并不会立即释放对应的内存空间。

由于redis采用了**定期删除**和**惰性删除**的方式来删除key，这两种机制意味着redis中的**key过期清理并不是实时的**，所有即使key过期了redis也不会立即删除它们。

只有在执行定期删除和访问（触发惰性删除）时，才会进行清理操作。

因此，一些过期的key可能会在一段时间内仍然存在于redis中，直到触发了相应的清理机制。



## 定期删除

**定时删除**：redis会每隔一段时间执行一次定期删除操作。在每次执行定时删除的时候，redis会随机抽取一部分key，并检查它们是否已经过期了，如果发现有过期的key，就直接删除，并释放对应的内存空间。

>   这种机制保证了redis能够定期清理掉过期的key，并不保证所有过期的key会被立即清理掉

## 惰性删除

**惰性删除**：指的是当一个key被访问时，redis会检测key是否已经过期，如果过期了则直接删除，并释放对应的内存空间
